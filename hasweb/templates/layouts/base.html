<!DOCTYPE html>
<html lang="en" class="svg inlinesvg">
  <head>
    <title>{{ ctx.title }}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta name="theme-color" content="{{ ctx.colors.primary }}"/>
    <meta name="description" content="{{ ctx.meta.description }}">
    <meta name="keywords" content="{{ ctx.meta.keywords }}">
    <link rel="shortcut icon" href="{{ ctx.meta.favicon }}" />
    {% if ctx.canonical %}
    <link rel="canonical" href="{{ page.canonical }}" />
    {% endif %}

    <meta property="og:url" content="{{ ctx.meta.og.url }}">
    <meta property="og:image" content="{{ ctx.meta.og.image }}">
    <meta property="og:description" content="{{ ctx.meta.og.description }}">
    <meta property="og:title" content="{{ ctx.meta.og.title }}">
    <meta property="og:site_name" content="{{ ctx.meta.og.site_name }}">
    <meta property="og:see_also" content="{{ ctx.meta.og.see_also }}">
    <meta property="og:type" content="{{ ctx.meta.og.type }}">

    <meta itemprop="name" content="{{ ctx.meta.title }}">
    <meta itemprop="description" content="{{ ctx.meta.description }}">
    <meta itemprop="image" content="{{ ctx.meta.image }}">

    <meta name="twitter:card" content="{{ ctx.meta.twitter.card }}">
    <meta name="twitter:url" content="{{ ctx.meta.twitter.url }}">
    <meta name="twitter:title" content="{{ ctx.meta.twitter.title }}">
    <meta name="twitter:description" content="{{ ctx.meta.twitter.description }}">
    <meta name="twitter:image" content="{{ ctx.meta.twitter.image }}">


    <link rel="manifest" href="{{ ctx.meta.manifest }}">

    <link rel="stylesheet" href="{{ url_for('') }}">

    {% if page.custom_css %}
    <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}/css/{{ page.custom_css }}">
    {% endif %}
  {% include "components/" %}

    {% if page.venue %}
      {% if page.venue.mapbox %}
      <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}/css/mapbox-gl-0.39.1.css">
      {% else %}
      <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}/css/leaflet.css">
      {% endif %}
    {% endif %}

    <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}/static/css/jquery.sidr.2.2.1.min.css">
    <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}/css/font-awesome.min.css">
</head>
<body>
  {% include sidebar_site.html %}

  {% include navbar_site.html %}

  {{ content }}

  <script src="{{ site.url }}{{ site.baseurl }}/js/jquery-3.2.1.min.js"></script>
  <script src="{{ site.url }}{{ site.baseurl }}/js/jquery.sidr-2.2.1.min.js"></script>
  <script src="{{ site.url }}{{ site.baseurl }}/js/mustache.min.js"></script>
{% if page.venue %}
  {% if page.venue.mapbox %}
  <script src="{{ site.url }}{{ site.baseurl }}/js/mapbox-gl.0.39.1.min.js"></script>
  {% else %}
  <script src="{{ site.url }}{{ site.baseurl }}/js/leaflet.js"></script>
  {% endif %}
{% endif %}
<script>
    window.Event = {};
</script>
<script>
  $(document).ready( function() {

    var stickyNav = $(".nav-sticky");
    var navHeight;
    if (stickyNav.length > 0) {
      stuck = "nav-stuck";
      headerHeight = $(stickyNav[0]).offset().top;
      nextSibling = stickyNav.parent().next()[0];
      navHeight = stickyNav[0].clientHeight;
      $(window).scroll(function() {
        if( $(this).scrollTop() > headerHeight) {
          stickyNav.parent().addClass(stuck);
          nextSibling.style.marginTop = navHeight+"px";
        } else {
          stickyNav.parent().removeClass(stuck);
          nextSibling.style.marginTop = 0;
        }
      });
    }
    $("a").click(function (e) {
      var goto = $(this).attr('data-href');
      if (goto) {
        // Prevent a page reload when a link is pressed
        e.preventDefault();
        // Scroll to section
        var offset_top = $(goto).offset().top - navHeight || 0;
        $("body,html").stop(true,true).animate({scrollTop:offset_top},300)
      }
    });

    {% if page.venue %}
      initLeaflets();
    {% endif %}

    $('#sidebar').show();
    $('.nav-toggle').sidr({
      name: 'sidebar',
      source: '#sidebar',
      renaming: false
    });

  })

  function goToUrl(url) {
    window.location.href = url;
  }
  function showModal(modalId) {
    $('#'+modalId).addClass('is-active');
  }
  function hideModal(modalId) {
    $('#'+modalId).removeClass('is-active');
  }
</script>
{% if page.boxoffice_item_collection %}
  {% include boxoffice_js.html %}
{% endif %}

{% if page.schedule %}
  <script>
    window.Event.schedule_url = "{{ page.schedule.json_url }}";
    window.Event.schedule_type = "{{ page.schedule.type }}";
  </script>
  <script src="{{ site.url }}{{ site.baseurl }}/js/schedule.js"></script>
{% endif %}

{% if page.show_proposals %}
  <script>
    window.Event.proposal_url = "{{ page.show_proposals.url }}";
  </script>
  <script src="{{ site.url }}{{ site.baseurl }}/js/proposal.js"></script>
{% endif %}

{% include analytics.html ga_tracking_code=site.ga_tracking_code %}


{% if site.service_worker == 'false' %}
{% else %}
<script type="text/javascript">
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('{{ site.url }}{{ site.baseurl }}/sw.js').then(function () {
    // console.log('Service worker registered');
    }).catch(function() {
    // console.log('Service worker registration failed');
  });
};
</script>
{% endif %}

</body>
</html>
